<%= header %>
<%= boomerangScript %>

<script type="text/javascript">
BOOMR.utils.removeCookie("RT");

function handler(event) {
	var data = JSON.parse(event.data);
	if (data && data.dm) {
		window.childSessionData = data;
	}
}

if (window.addEventListener) {
	window.addEventListener("message", handler);
}
else {
	window.attachEvent("onmessage", handler);
}
</script>

<script src="01-child-iframe-delayed.js" type="text/javascript"></script>
<script>
var server = "<%= secondaryServer %>";
var host = server || window.location.hostname;
var port = (parseInt(window.location.port) || 4002) + 1;

BOOMR_test.init({
	testAfterOnBeacon: true,
	CrossDomain: {
		cross_domain_url: "http://" + host + ":" + port + "/delay?delay=200&file=/pages/15-cross-domain/support/frameScriptSimple.html",
		sending: false,
		session_transfer_timeout: 1000
	}
});
</script>

<pre>
  Ensure we are recording the correct amount of delay between requesting and receiving data

 +---------+        +----------+
 |  Alias  +---?---->   Main   |
 +---------+        +----------+

 +---------+
 |   Main  +------> ... Thinking ...
 +---------+

 +---------+        +----------+
 |  Main   +---!---->  Alias   |
 +---------+        +----------+
</pre>
<%= footer %>
