<%= header %>
<%= boomerangScript %>
<script src="08-resource-groups.js" type="text/javascript"></script>
<div id="wrapper">
	<div id="element">
		<img src="/delay?delay=1000&amp;id=abc&amp;file=/pages/04-page-params/support/img.jpg" style="width:100px;"/>
	</div>
	<div id="extra">
		<img src="/delay?delay=1000&amp;id=def&amp;file=/pages/04-page-params/support/img.jpg" style="width:100px;"/>
	</div>
</div>

<div class="single part" id="single-part1">
	<img src="/delay?delay=1000&amp;id=zzz&amp;file=/pages/04-page-params/support/img.jpg" style="width:100px;"/>
</div>
<div class="single part2" id="single-part2">
	<img src="/delay?delay=2000&amp;id=yyy&amp;file=/pages/04-page-params/support/img.jpg" style="width:100px;"/>
</div>

<!--
	2017-07-24: This last image of 3 seconds is used to ensure Edge waits for the
	previous 4 images before firing pageshow.  Currently in Edge 15, the "last image" (whatever
	is delaying onload) is sometimes not yet visually on the page and its is responseEnd==0.
-->
<img src="/delay?delay=3000&amp;id=last&amp;file=/pages/04-page-params/support/img.jpg?last-image" style="width:100px;"/>

<div id="late"></div>

<script type="text/javascript">
// load image dynamically after ResourceGroups has initialized
// total time (timeout + delay) must be less than onload or beacon will go out before the img is loaded
setTimeout(function() {
	var image = document.createElement("img");
	image.src = "/delay?delay=1000&file=/assets/img.jpg";

	var container = document.getElementById("late");
	container.appendChild(image);
}, 1000);

BOOMR_test.init({
	testAfterOnBeacon: true,
	ResourceTiming: {
		enabled: true
	},
	PageParams: {
		customTimers: [
			{
				name: "ResourceGroup Element selected via XPath",
				index: 1,
				label: "ctim.CT1",
				type: "ResourceGroup",
				value: {
					"*/08-resource-groups.html": {
						on: ["onload"],
						resources: [{
							type: "xpath",
							value: "//div[@id='element']/img"
						}]
					}
				}
			},
			{
				name: "ResourceGroup Element selected via QuerySelector",
				index: 2,
				label: "ctim.CT2",
				type: "ResourceGroup",
				value: {
					"*/08-resource-groups.html": {
						on: ["onload"],
						resources: [{
							type: "queryselector",
							value: "#element img"
						}]
					}
				}
			},
			{
				name: "ResourceGroup Element selected via Resource URL",
				index: 3,
				label: "ctim.CT3",
				type: "ResourceGroup",
				value: {
					"*/08-resource-groups.html": {
						on: ["onload"],
						resources: [{
							type: "resource",
							value: "*id=abc*"
						}]
					}
				}
			},
			{
				name: "ResourceGroup Container selected via XPath",
				index: 4,
				label: "ctim.CT4",
				type: "ResourceGroup",
				value: {
					"*/08-resource-groups.html": {
						on: ["onload"],
						resources: [{
							type: "xpath",
							value: "//div[@id='element']"
						}]
					}
				}
			},
			{
				name: "ResourceGroup Container selected via QuerySelector",
				index: 5,
				label: "ctim.CT5",
				type: "ResourceGroup",
				value: {
					"*/08-resource-groups.html": {
						on: ["onload"],
						resources: [{
							type: "queryselector",
							value: "#element"
						}]
					}
				}
			},
			{
				name: "ResourceGroup Element does not exist as XPath",
				index: 6,
				label: "ctim.CT6",
				type: "ResourceGroup",
				value: {
					"*/08-resource-groups.html": {
						on: ["onload"],
						resources: [{
							type: "xpath",
							value: "//div[@id='doesNotExist']"
						}]
					}
				}
			},
			{
				name: "ResourceGroup Element does not exist as QuerySelector",
				index: 7,
				label: "ctim.CT7",
				type: "ResourceGroup",
				value: {
					"*/08-resource-groups.html": {
						on: ["onload"],
						resources: [{
							type: "queryselector",
							value: "#doesNotExist"
						}]
					}
				}
			},
			{
				name: "ResourceGroup Element does not exist as Resource",
				index: 8,
				label: "ctim.CT8",
				type: "ResourceGroup",
				value: {
					"*/08-resource-groups.html": {
						on: ["onload"],
						resources: [{
							type: "resource",
							value: "doesnotexist.jpg"
						}]
					}
				}
			},
			{
				name: "ResourceGroup URLPattern doesn't match",
				index: 9,
				label: "ctim.CT9",
				type: "ResourceGroup",
				value: {
					"*does_not_exist": {
						on: ["onload"],
						resources: [{
							type: "xpath",
							value: "//div[@id='element']/img"
						}]
					}
				}
			},
			{
				name: "ResourceGroup Container with multiple resources selected via XPath",
				index: 10,
				label: "ctim.CT10",
				type: "ResourceGroup",
				value: {
					"*/08-resource-groups.html": {
						on: ["onload"],
						resources: [{
							type: "xpath",
							value: "//div[@id='wrapper']"
						}]
					}
				}
			},
			{
				name: "ResourceGroup Container with multiple resources selected via QuerySelector",
				index: 11,
				label: "ctim.CT11",
				type: "ResourceGroup",
				value: {
					"*/08-resource-groups.html": {
						on: ["onload"],
						resources: [{
							type: "queryselector",
							value: "#wrapper"
						}]
					}
				}
			},
			{
				name: "ResourceGroup Container with multiple resources selected via resource URL",
				index: 12,
				label: "ctim.CT12",
				type: "ResourceGroup",
				value: {
					"*/08-resource-groups.html": {
						on: ["onload"],
						resources: [{
							type: "resource",
							value: "*support/img.jpg"
						}]
					}
				}
			},
			{
				name: "ResourceGroup Container with multiple resources selected via resource URL",
				index: 13,
				label: "ctim.CT13",
				type: "ResourceGroup",
				value: {
					"*/08-resource-groups.html": {
						on: ["onload"],
						resources: [{
							type: "resource",
							value: "*id=abc*"
						}]
					},
					"*/*": {
						on: ["onload"],
						resources: [{
							type: "resource",
							value: "*id=def*"
						}]
					}
				}
			},
			{
				name: "ResourceGroup matching multiple containers with resources inside",
				index: 14,
				label: "ctim.CT14",
				type: "ResourceGroup",
				value: {
					"*/08-resource-groups.html": {
						on: ["onload"],
						resources: [{
							type: "queryselector",
							value: ".single"
						}]
					}
				}
			},
			{
				name: "ResourceGroup Element that starts after init",
				index: 15,
				label: "ctim.CT15",
				type: "ResourceGroup",
				value: {
					"*/08-resource-groups.html": {
						on: ["onload"],
						resources: [{
							type: "resource",
							value: "*assets/img.jpg"
						}]
					}
				}
			}
		]
	}
});
</script>
