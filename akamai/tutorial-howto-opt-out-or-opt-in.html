<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>mPulse Boomerang Tutorial: Opt-out or Opt-in</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.akamai.css">

</head>

<body>

<div class="navbar navbar-default navbar-fixed-top ">
<div class="container">
	<div class="navbar-header">
		<a class="navbar-brand" href="index.html">mPulse Boomerang</a>
		<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#topNavigation">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
        </button>
	</div>
	<div class="navbar-collapse collapse" id="topNavigation">
		<ul class="nav navbar-nav">
			
			<li class="dropdown">
				<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="BOOMR.html">BOOMR</a></li><li><a href="BOOMR.browser.html">BOOMR.browser</a></li><li><a href="BOOMR.constants.html">BOOMR.constants</a></li><li><a href="BOOMR.plugins.html">BOOMR.plugins</a></li><li><a href="BOOMR.plugins.Akamai.html">BOOMR.plugins.Akamai</a></li><li><a href="BOOMR.plugins.AutoXHR.html">BOOMR.plugins.AutoXHR</a></li><li><a href="BOOMR.plugins.BFCache.html">BOOMR.plugins.BFCache</a></li><li><a href="BOOMR.plugins.BW.html">BOOMR.plugins.BW</a></li><li><a href="BOOMR.plugins.CACHE_RELOAD.html">BOOMR.plugins.CACHE_RELOAD</a></li><li><a href="BOOMR.plugins.Clicks.html">BOOMR.plugins.Clicks</a></li><li><a href="BOOMR.plugins.ConfigOverride.html">BOOMR.plugins.ConfigOverride</a></li><li><a href="BOOMR.plugins.ConsentInlinedPlugin.html">BOOMR.plugins.ConsentInlinedPlugin</a></li><li><a href="BOOMR.plugins.Continuity.html">BOOMR.plugins.Continuity</a></li><li><a href="BOOMR.plugins.CrossDomain.html">BOOMR.plugins.CrossDomain</a></li><li><a href="BOOMR.plugins.CT.html">BOOMR.plugins.CT</a></li><li><a href="BOOMR.plugins.DNS.html">BOOMR.plugins.DNS</a></li><li><a href="BOOMR.plugins.Early.html">BOOMR.plugins.Early</a></li><li><a href="BOOMR.plugins.Errors.html">BOOMR.plugins.Errors</a></li><li><a href="BOOMR.plugins.EventTiming.html">BOOMR.plugins.EventTiming</a></li><li><a href="BOOMR.plugins.GUID.html">BOOMR.plugins.GUID</a></li><li><a href="BOOMR.plugins.History.html">BOOMR.plugins.History</a></li><li><a href="BOOMR.plugins.IFrameDelay.html">BOOMR.plugins.IFrameDelay</a></li><li><a href="BOOMR.plugins.IPv6.html">BOOMR.plugins.IPv6</a></li><li><a href="BOOMR.plugins.LOGN.html">BOOMR.plugins.LOGN</a></li><li><a href="BOOMR.plugins.Memory.html">BOOMR.plugins.Memory</a></li><li><a href="BOOMR.plugins.Mobile.html">BOOMR.plugins.Mobile</a></li><li><a href="BOOMR.plugins.NavigationTiming.html">BOOMR.plugins.NavigationTiming</a></li><li><a href="BOOMR.plugins.PageParams.html">BOOMR.plugins.PageParams</a></li><li><a href="BOOMR.plugins.PaintTiming.html">BOOMR.plugins.PaintTiming</a></li><li><a href="BOOMR.plugins.ResourceTiming.html">BOOMR.plugins.ResourceTiming</a></li><li><a href="BOOMR.plugins.RT.html">BOOMR.plugins.RT</a></li><li><a href="BOOMR.plugins.SPA.html">BOOMR.plugins.SPA</a></li><li><a href="BOOMR.plugins.TPAnalytics.html">BOOMR.plugins.TPAnalytics</a></li><li><a href="BOOMR.plugins.UserTiming.html">BOOMR.plugins.UserTiming</a></li><li><a href="BOOMR.session.html">BOOMR.session</a></li><li><a href="BOOMR.utils.html">BOOMR.utils</a></li><li><a href="BOOMR.utils.Compression.html">BOOMR.utils.Compression</a></li><li><a href="BOOMR_mq.html">BOOMR_mq</a></li><li><a href="MutationHandler.html">MutationHandler</a></li><li><a href="ProxyXHRImplementation.html">ProxyXHRImplementation</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="events.list.html" class="dropdown-toggle" data-toggle="dropdown">Events<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="BOOMR.html#event:beacon">BOOMR#event:beacon</a></li><li><a href="BOOMR.html#event:before_beacon">BOOMR#event:before_beacon</a></li><li><a href="BOOMR.html#event:before_early_beacon">BOOMR#event:before_early_beacon</a></li><li><a href="BOOMR.html#event:before_unload">BOOMR#event:before_unload</a></li><li><a href="BOOMR.html#event:bfcache">BOOMR#event:bfcache</a></li><li><a href="BOOMR.html#event:click">BOOMR#event:click</a></li><li><a href="BOOMR.html#event:config">BOOMR#event:config</a></li><li><a href="BOOMR.html#event:dom_loaded">BOOMR#event:dom_loaded</a></li><li><a href="BOOMR.html#event:error">BOOMR#event:error</a></li><li><a href="BOOMR.html#event:form_submit">BOOMR#event:form_submit</a></li><li><a href="BOOMR.html#event:netinfo">BOOMR#event:netinfo</a></li><li><a href="BOOMR.html#event:page_load_beacon">BOOMR#event:page_load_beacon</a></li><li><a href="BOOMR.html#event:page_ready">BOOMR#event:page_ready</a></li><li><a href="BOOMR.html#event:page_unload">BOOMR#event:page_unload</a></li><li><a href="BOOMR.html#event:prerender_to_visible">BOOMR#event:prerender_to_visible</a></li><li><a href="BOOMR.html#event:rage_click">BOOMR#event:rage_click</a></li><li><a href="BOOMR.html#event:spa_cancel">BOOMR#event:spa_cancel</a></li><li><a href="BOOMR.html#event:spa_init">BOOMR#event:spa_init</a></li><li><a href="BOOMR.html#event:spa_navigation">BOOMR#event:spa_navigation</a></li><li><a href="BOOMR.html#event:visibility_changed">BOOMR#event:visibility_changed</a></li><li><a href="BOOMR.html#event:xhr_error">BOOMR#event:xhr_error</a></li><li><a href="BOOMR.html#event:xhr_init">BOOMR#event:xhr_init</a></li><li><a href="BOOMR.html#event:xhr_load">BOOMR#event:xhr_load</a></li><li><a href="BOOMR.html#event:xhr_send">BOOMR#event:xhr_send</a></li><li><a href="document.html#event:onBeforeBoomerangBeacon">document#event:onBeforeBoomerangBeacon</a></li><li><a href="document.html#event:onBoomerangBeacon">document#event:onBoomerangBeacon</a></li><li><a href="document.html#event:onBoomerangLoaded">document#event:onBoomerangLoaded</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="tutorials.list.html" class="dropdown-toggle" data-toggle="dropdown">Tutorials<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="tutorial-README.template.html">README.template</a></li><li><a href="tutorial-building.html">Building</a></li><li><a href="tutorial-contributing.html">Contributing</a></li><li><a href="tutorial-creating-plugins.html">Creating Plugins</a></li><li><a href="tutorial-header-snippets.html">Header Snippets</a></li><li><a href="tutorial-howtos.html">How-Tos</a></li><li><a href="tutorial-loader-snippet.html">Non-Blocking Loader Snippet</a></li><li><a href="tutorial-methodology.html">Methodology</a></li><li><a href="tutorial-page-overrides.html">Page Overrides</a></li><li><a href="tutorial-perf-tests.html">Performance Tests</a></li><li><a href="tutorial-tests.html">Tests</a></li><li><a href="tutorial-version-history.html">Version History</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="global.html" class="dropdown-toggle" data-toggle="dropdown">Global<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="global.html#BOOMR_check_doc_domain">BOOMR_check_doc_domain</a></li><li><a href="global.html#BOOMR_lstart">BOOMR_lstart</a></li><li><a href="global.html#BOOMR_onload">BOOMR_onload</a></li><li><a href="global.html#BOOMR_start">BOOMR_start</a></li>
				</ul>
			</li>
			
		</ul>
        
            <div class="col-sm-3 col-md-3">
                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search" name="q" id="search-input">
                        <div class="input-group-btn">
                            <button class="btn btn-default" id="search-submit"><i class="glyphicon glyphicon-search"></i></button>
                        </div>
                    </div>
                </form>
            </div>
        
	</div>

</div>
</div>


<div class="container" id="toc-content">
<div class="row">

	
	<div class="col-md-12">
	
		<div id="main">
			<section class="tutorial-section">

<header>
    <h1>Opt-out or Opt-in</h1>
</header>

<article>
    <h2>Disclaimer</h2>
<p>This tutorial does not constitute legal advice or a legal opinion on any matter discussed. This tutorial is for educational purposes only. If you have a specific legal question, please consult with an attorney of your own choice.</p>
<p>Boomerang is an open source JavaScript library that measures a web site’s performance. As such it is considered in some countries in the EU and Asia as <strong>“cookie technology”</strong> and triggers certain data protection requirements. Such requirements vary depending on the categorization of cookie technology used for website performance measurement by local authorities. Some authorities require consent by end users to the cookie technology prior to its placement on a website (<strong>&quot;opt-in&quot;</strong>). According to <strong>GDPR</strong> and other applicable laws, such consent must be freely given, specific, informed and unambiguous. Some authorities accept the placement of cookie technology on a website without consent and require the implementation of a mechanism to stop the cookie usage once the end user requests so (<strong>&quot;opt-out&quot;</strong>). Such setup is e.g. accepted under <strong>CCPA</strong>, the California Consumer Privacy Act that entered into force January 1, 2020.</p>
<p>This tutorial describes techniques and configurations that help Boomerang users to instrument opt-out and opt-in scenarios. In addition the tutorial describes how to instrument 3 different consent management techniques via special <a href="./BOOMR.plugins.ConsentInlinedPlugin.html">Consent Inlined Plugin</a>, a Boomerang Loader Wrapper and the Osano Cookies Consent library.</p>
<p>Tutorial structure:</p>
<ol>
<li><a href="#disclaimer">Disclaimer</a></li>
<li><a href="#opt-out-and-opt-in-scenarios">Opt-out and Opt-in scenarios</a>
<ol>
<li><a href="#opt-out-from-boomerang">Opt-out from Boomerang</a></li>
<li><a href="#opt-in-to-boomerang-boomerang-loaded-before-opt-in">Opt-in to Boomerang (Boomerang loaded before opt-in)</a></li>
<li><a href="#opt-in-to-boomerang-boomerang-loaded-after-opt-in">Opt-in to Boomerang (Boomerang loaded after opt-in)</a></li>
</ol>
</li>
<li><a href="#cookies-and-local-storage">Cookies and Local Storage</a>
<ol>
<li><a href="#cookies">Cookies</a></li>
<li><a href="#local-storage-mpulse-users-specific">Local Storage (mPulse users specific)</a></li>
</ol>
</li>
<li><a href="#consent-inline-plugin">Consent Inline Plugin</a>
<ol>
<li><a href="#opt-out-allowed-example">Opt-out allowed example</a></li>
<li><a href="#opt-in-required-example">Opt-in required example</a></li>
</ol>
</li>
<li><a href="#opt-in-with-boomerang-loader-wrapper">Opt-in with Boomerang Loader Wrapper</a></li>
<li><a href="#cookie-consent-library-and-consent-inline-plugin-example">Cookie Consent library and Consent Inline Plugin example</a>
<ol>
<li><a href="#opt-out">Opt-out</a></li>
<li><a href="#opt-in">Opt-in</a></li>
</ol>
</li>
</ol>
<h2>Opt-out and Opt-in scenarios</h2>
<p>We identified 3 common scenarios how Boomerang could be loaded to comply with the applicable data protection requirements.</p>
<h3>Opt-out from Boomerang</h3>
<p>By default Boomerang is loaded on the page and sends performance data. Boomerang will be disabled and the Boomerang cookies will be deleted if a visitor opts-out from Boomerang through Cookie Consent popup.</p>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:left">Before opt-out</th>
<th style="text-align:left">After opt-out</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Boomerang Loaded</td>
<td style="text-align:left">Yes</td>
<td style="text-align:left">Yes</td>
</tr>
<tr>
<td style="text-align:left">Beacons Sent</td>
<td style="text-align:left">Yes</td>
<td style="text-align:left">No</td>
</tr>
<tr>
<td style="text-align:left">RT Cookie exists</td>
<td style="text-align:left">Yes</td>
<td style="text-align:left">No</td>
</tr>
<tr>
<td style="text-align:left">BA Cookie  exists</td>
<td style="text-align:left">Yes</td>
<td style="text-align:left">No</td>
</tr>
<tr>
<td style="text-align:left">BOOMR_CONSENT Cookie  exists</td>
<td style="text-align:left">No</td>
<td style="text-align:left">Yes (value <code>opted-out</code>)</td>
</tr>
<tr>
<td style="text-align:left">Extra beacon params</td>
<td style="text-align:left">No</td>
<td style="text-align:left">No</td>
</tr>
</tbody>
</table>
<h3>Opt-in to Boomerang (Boomerang loaded before opt-in)</h3>
<p>By default Boomerang is loaded on the page and does <strong>NOT</strong> send performance data. Performance data will be sent after a visitor opts-in to Boomerang through a Cookie Consent popup.</p>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:left">Before opt-in</th>
<th style="text-align:left">After opt-in</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Boomerang Loaded</td>
<td style="text-align:left">Yes</td>
<td style="text-align:left">Yes</td>
</tr>
<tr>
<td style="text-align:left">Beacons Sent</td>
<td style="text-align:left">No</td>
<td style="text-align:left">Yes</td>
</tr>
<tr>
<td style="text-align:left">RT Cookie exists</td>
<td style="text-align:left">Yes</td>
<td style="text-align:left">Yes</td>
</tr>
<tr>
<td style="text-align:left">BA Cookie  exists</td>
<td style="text-align:left">Yes</td>
<td style="text-align:left">Yes</td>
</tr>
<tr>
<td style="text-align:left">BOOMR_CONSENT Cookie  exists</td>
<td style="text-align:left">No</td>
<td style="text-align:left">Yes (value <code>opted-in</code>)</td>
</tr>
<tr>
<td style="text-align:left">Extra beacon params</td>
<td style="text-align:left">No</td>
<td style="text-align:left"><code>cip.in</code>, <code>cip.v</code></td>
</tr>
</tbody>
</table>
<ul>
<li><code>cip.in</code>, <code>cip.v</code> parameters are being sent on first beacon after opt-in and they indicate that visitor opted-in and Consent Inlined Plugin version.</li>
</ul>
<h3>Opt-in to Boomerang (Boomerang loaded after opt-in)</h3>
<p>Boomerang will be loaded and performance data sent after only after a visitor opts-in to Boomerang through the Cookie Consent popup.</p>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:left">Before opt-in</th>
<th style="text-align:left">After opt-in</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Boomerang Loaded</td>
<td style="text-align:left">No</td>
<td style="text-align:left">Yes</td>
</tr>
<tr>
<td style="text-align:left">Beacons Sent</td>
<td style="text-align:left">No</td>
<td style="text-align:left">Yes</td>
</tr>
<tr>
<td style="text-align:left">RT Cookie exists</td>
<td style="text-align:left">No</td>
<td style="text-align:left">Yes</td>
</tr>
<tr>
<td style="text-align:left">BA Cookie  exists</td>
<td style="text-align:left">No</td>
<td style="text-align:left">Yes</td>
</tr>
<tr>
<td style="text-align:left">Extra beacon params</td>
<td style="text-align:left">No</td>
<td style="text-align:left">No</td>
</tr>
</tbody>
</table>
<h2>Cookies and Local Storage</h2>
<h3>Cookies</h3>
<p>List of cookies created and used by Boomerang:</p>
<table>
<thead>
<tr>
<th style="text-align:left">Name</th>
<th style="text-align:left">Expires</th>
<th style="text-align:left">Type</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>RT</code></td>
<td style="text-align:left">7 days</td>
<td style="text-align:left">First-party</td>
<td style="text-align:left">Doesn't contain personal information but it contains various pieces of information about the visitor's session, such as number of visited pages, session start time, last visited url and etc.</td>
</tr>
<tr>
<td style="text-align:left"><code>BA</code></td>
<td style="text-align:left">7 days</td>
<td style="text-align:left">First-party</td>
<td style="text-align:left">Used by Bandwidth Boomerang plugin. Doesn't contain personal information.</td>
</tr>
<tr>
<td style="text-align:left"><code>BOOMR_CONSENT</code></td>
<td style="text-align:left">1 year</td>
<td style="text-align:left">First-party</td>
<td style="text-align:left">Contains information about visitor's choice for opt-out or opt-in.</td>
</tr>
</tbody>
</table>
<p>For detailed information about what data is kept on the cookies listed above, please read the &quot;Cookies&quot; section of <a href="https://developer.akamai.com/tools/boomerang/#Cookies">Boomerang documentation page</a>.</p>
<h3>Local Storage (mPulse users specific)</h3>
<p>For mPulse customers, in some instances Boomerang will persist data in Browser's Local Storage. In these instances a Local Storage is used for performance optimization and reduction of network round trips.</p>
<p>List of local storage keys used by Boomerang:</p>
<table>
<thead>
<tr>
<th style="text-align:left">Key</th>
<th style="text-align:left">Plugin</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>_boomr_LOGN</code></td>
<td style="text-align:left">LOGN</td>
<td style="text-align:left">Persists Boomerang JSON configuration. Helps for faster Boomerang initialization. Doesn't contain personal information.</td>
</tr>
<tr>
<td style="text-align:left"><code>_boomr_akamaiXhrRetry</code></td>
<td style="text-align:left">Akamai</td>
<td style="text-align:left">Persists a flag that instructs the Akamai plugin when to perform requests. Doesn't contain personal information.</td>
</tr>
</tbody>
</table>
<h2>Consent Inline Plugin</h2>
<p>The Consent Inline Plugin is not part of the Boomerang build but it could be easily injected before Boomerang code which will make the plugin available. The plugin provides 2 helper functions <code>window.BOOMR_OPT_OUT()</code> and <code>window.BOOMR_OPT_IN()</code> that can be used for instrumenting opt-out and opt-in.</p>
<p>When <code>window.BOOMR_OPT_OUT()</code> is called Boomerang will stop sending beacon data, <code>RT</code> and <code>BA</code> cookies will be deleted and the new special <code>BOOMR_CONSENT</code> cookie with value <code>opted-out</code> will be created.</p>
<p>Consent Inline Plugin has the capability to instruct Boomerang to hold beacon sending until <code>window.BOOMR_OPT_IN()</code> is called. When <code>window.BOOMR_OPT_IN()</code> is called a cookie <code>BOOMR_CONSENT</code> with value <code>opted-in</code> will be created.</p>
<p>The purpose of <code>BOOMR_CONSENT</code> cookie is to &quot;tell&quot; Boomerang what was the visitor's consent choice when a visitor navigates to a new page.</p>
<h3>Opt-out allowed example</h3>
<p>In case we would like to allow website visitors to opt-out from Boomerang we must follow the steps in this order:</p>
<ol>
<li>Inject Consent Inline Plugin configuration:</li>
</ol>
<pre class="prettyprint source lang-html"><code>&lt;script>
window.BOOMR_CONSENT_CONFIG = {
  enabled: true
};
&lt;/script>
</code></pre>
<ol start="2">
<li>Inject Consent Inline Plugin code:</li>
</ol>
<pre class="prettyprint source lang-html"><code>&lt;script>
!function(o){&quot;use strict&quot;;if(void 0!==o.BOOMR_CONSENT_CONFIG&amp;&amp;!0===o.BOOMR_CONSENT_CONFIG.enabled){o.BOOMR=void 0!==o.BOOMR?o.BOOMR:{};var n=o.BOOMR;n.plugins=void 0!==n.plugins?n.plugins:{};if(!n.plugins.ConsentInlinedPlugin){var i={v:&quot;2&quot;,OPT_COOKIE:&quot;BOOMR_CONSENT&quot;,OPT_IN_COOKIE_VAL:&quot;opted-in&quot;,OPT_OUT_COOKIE_VAL:&quot;opted-out&quot;,COOKIE_EXP:31536e3,complete:!1,enabled:!0,firedPageReady:!1,deferredOptIn:!1,deferredOptOut:!1,rtCookieFromConfig:!1,bwCookieFromConfig:!1,optOut:function(){if(!n.utils.setCookie(i.OPT_COOKIE,i.OPT_OUT_COOKIE_VAL,i.COOKIE_EXP)){n.error(&quot;Can not set Opt Out cookie&quot;,&quot;ConsentInlinedPlugin&quot;);return!1}&quot;function&quot;==typeof n.disable&amp;&amp;n.disable();i.complete=!1;i.removeBoomerangCookies();return!0},optIn:function(){if(!0===i.complete)return!0;if(!n.utils.setCookie(i.OPT_COOKIE,i.OPT_IN_COOKIE_VAL,i.COOKIE_EXP)){n.error(&quot;Can not set Opt In value&quot;,&quot;ConsentInlinedPlugin&quot;);return!1}&quot;function&quot;==typeof n.wakeUp&amp;&amp;n.wakeUp();i.complete=!0;n.addVar(&quot;cip.in&quot;,&quot;1&quot;,!0);n.addVar(&quot;cip.v&quot;,i.v,!0);n.sendBeacon();return!0},removeBoomerangCookies:function(){var e=i.rtCookieFromConfig||&quot;RT&quot;,o=i.bwCookieFromConfig||&quot;BA&quot;;n.utils.removeCookie(e);n.utils.removeCookie(o)},onPageReady:function(){if(!i.firedPageReady){i.firedPageReady=!0;if(i.deferredOptIn){i.optIn();i.deferredOptIn=!1}if(i.deferredOptOut){i.optOut();i.deferredOptOut=!1}}}};o.BOOMR_OPT_OUT=function(){i.firedPageReady?i.optOut():i.deferredOptOut=!0};o.BOOMR_OPT_IN=function(){i.firedPageReady?i.optIn():i.deferredOptIn=!0};n.plugins.ConsentInlinedPlugin={init:function(e){void 0!==e.RT&amp;&amp;void 0!==e.RT.cookie&amp;&amp;(i.rtCookieFromConfig=e.RT.cookie);void 0!==e.BW&amp;&amp;void 0!==e.BW.cookie&amp;&amp;(i.bwCookieFromConfig=e.BW.cookie);n.subscribe(&quot;page_ready&quot;,i.onPageReady,null,i);n.subscribe(&quot;spa_navigation&quot;,i.onPageReady,null,i);if(o.BOOMR_CONSENT_CONFIG.optInRequired&amp;&amp;n.utils.getCookie(i.OPT_COOKIE)!==i.OPT_IN_COOKIE_VAL){i.complete=!1;return this}if(n.utils.getCookie(i.OPT_COOKIE)===i.OPT_OUT_COOKIE_VAL){void 0===e.RT&amp;&amp;(e.RT={});e.RT.cookie=&quot;&quot;;void 0===e.BW&amp;&amp;(e.BW={});e.BW.cookie=&quot;&quot;;i.complete=!1;return this}i.complete=!0;return this},is_complete:function(){return i.complete},debug:{wasPageReadyFired:function(){return i.firedPageReady},getDeferredOptInFlag:function(){return i.deferredOptIn},getDeferredOptOutFlag:function(){return i.deferredOptOut},getRtCookieFromConfig:function(){return i.rtCookieFromConfig},getBwCookieFromConfig:function(){return i.bwCookieFromConfig},isOptedIn:function(){return!(!o.BOOMR_CONSENT_CONFIG.optInRequired||-1===document.cookie.indexOf(i.OPT_COOKIE+'=&quot;'+i.OPT_IN_COOKIE_VAL+'&quot;'))},isOptedOut:function(){return-1!==document.cookie.indexOf(i.OPT_COOKIE+'=&quot;'+i.OPT_OUT_COOKIE_VAL+'&quot;')}}}}}}(window);
&lt;/script>
</code></pre>
<ol start="3">
<li>Load Boomerang via loader snippet.</li>
<li>Call <code>window.BOOMR_OPT_OUT()</code> when visitor opts-out via Cookie consent popup or other UI element.</li>
</ol>
<h3>Opt-in required example</h3>
<p>When we would like to not send Beacon data until visitor opts-in to Boomerang we must follow the steps in this order:</p>
<ol>
<li>Inject Consent Inline Plugin configuration:</li>
</ol>
<pre class="prettyprint source lang-html"><code>&lt;script>
window.BOOMR_CONSENT_CONFIG = {
  enabled: true,
  optInRequired: true
};
&lt;/script>
</code></pre>
<ol start="2">
<li>Inject Consent Inline Plugin code:</li>
</ol>
<pre class="prettyprint source lang-html"><code>&lt;script>
!function(o){&quot;use strict&quot;;if(void 0!==o.BOOMR_CONSENT_CONFIG&amp;&amp;!0===o.BOOMR_CONSENT_CONFIG.enabled){o.BOOMR=void 0!==o.BOOMR?o.BOOMR:{};var n=o.BOOMR;n.plugins=void 0!==n.plugins?n.plugins:{};if(!n.plugins.ConsentInlinedPlugin){var i={v:&quot;2&quot;,OPT_COOKIE:&quot;BOOMR_CONSENT&quot;,OPT_IN_COOKIE_VAL:&quot;opted-in&quot;,OPT_OUT_COOKIE_VAL:&quot;opted-out&quot;,COOKIE_EXP:31536e3,complete:!1,enabled:!0,firedPageReady:!1,deferredOptIn:!1,deferredOptOut:!1,rtCookieFromConfig:!1,bwCookieFromConfig:!1,optOut:function(){if(!n.utils.setCookie(i.OPT_COOKIE,i.OPT_OUT_COOKIE_VAL,i.COOKIE_EXP)){n.error(&quot;Can not set Opt Out cookie&quot;,&quot;ConsentInlinedPlugin&quot;);return!1}&quot;function&quot;==typeof n.disable&amp;&amp;n.disable();i.complete=!1;i.removeBoomerangCookies();return!0},optIn:function(){if(!0===i.complete)return!0;if(!n.utils.setCookie(i.OPT_COOKIE,i.OPT_IN_COOKIE_VAL,i.COOKIE_EXP)){n.error(&quot;Can not set Opt In value&quot;,&quot;ConsentInlinedPlugin&quot;);return!1}&quot;function&quot;==typeof n.wakeUp&amp;&amp;n.wakeUp();i.complete=!0;n.addVar(&quot;cip.in&quot;,&quot;1&quot;,!0);n.addVar(&quot;cip.v&quot;,i.v,!0);n.sendBeacon();return!0},removeBoomerangCookies:function(){var e=i.rtCookieFromConfig||&quot;RT&quot;,o=i.bwCookieFromConfig||&quot;BA&quot;;n.utils.removeCookie(e);n.utils.removeCookie(o)},onPageReady:function(){if(!i.firedPageReady){i.firedPageReady=!0;if(i.deferredOptIn){i.optIn();i.deferredOptIn=!1}if(i.deferredOptOut){i.optOut();i.deferredOptOut=!1}}}};o.BOOMR_OPT_OUT=function(){i.firedPageReady?i.optOut():i.deferredOptOut=!0};o.BOOMR_OPT_IN=function(){i.firedPageReady?i.optIn():i.deferredOptIn=!0};n.plugins.ConsentInlinedPlugin={init:function(e){void 0!==e.RT&amp;&amp;void 0!==e.RT.cookie&amp;&amp;(i.rtCookieFromConfig=e.RT.cookie);void 0!==e.BW&amp;&amp;void 0!==e.BW.cookie&amp;&amp;(i.bwCookieFromConfig=e.BW.cookie);n.subscribe(&quot;page_ready&quot;,i.onPageReady,null,i);n.subscribe(&quot;spa_navigation&quot;,i.onPageReady,null,i);if(o.BOOMR_CONSENT_CONFIG.optInRequired&amp;&amp;n.utils.getCookie(i.OPT_COOKIE)!==i.OPT_IN_COOKIE_VAL){i.complete=!1;return this}if(n.utils.getCookie(i.OPT_COOKIE)===i.OPT_OUT_COOKIE_VAL){void 0===e.RT&amp;&amp;(e.RT={});e.RT.cookie=&quot;&quot;;void 0===e.BW&amp;&amp;(e.BW={});e.BW.cookie=&quot;&quot;;i.complete=!1;return this}i.complete=!0;return this},is_complete:function(){return i.complete},debug:{wasPageReadyFired:function(){return i.firedPageReady},getDeferredOptInFlag:function(){return i.deferredOptIn},getDeferredOptOutFlag:function(){return i.deferredOptOut},getRtCookieFromConfig:function(){return i.rtCookieFromConfig},getBwCookieFromConfig:function(){return i.bwCookieFromConfig},isOptedIn:function(){return!(!o.BOOMR_CONSENT_CONFIG.optInRequired||-1===document.cookie.indexOf(i.OPT_COOKIE+'=&quot;'+i.OPT_IN_COOKIE_VAL+'&quot;'))},isOptedOut:function(){return-1!==document.cookie.indexOf(i.OPT_COOKIE+'=&quot;'+i.OPT_OUT_COOKIE_VAL+'&quot;')}}}}}}(window);
&lt;/script>
</code></pre>
<ol start="3">
<li>Load Boomerang via loader snippet.</li>
<li>Call <code>window.BOOMR_OPT_IN()</code> when a visitor opted in via Cookie consent popup or other UI element.</li>
</ol>
<h2>Opt-in with Boomerang Loader Wrapper</h2>
<p>Users of Boomerang open source and some mPulse customers have to manually inject Boomerang on the page. This opens a possibility of waiting for the Boomerang loader snippet to be executed until after a visitor opts-in to Boomerang through Cookie Consent popup. By doing so, Boomerang won't be loaded until after opt-in has been chosen.</p>
<p>This technique is simple and can be done in 2 steps:</p>
<ol>
<li>Wrap Boomerang loader snippet in <strong>BOOMERANG_LOADER_SNIPPET_WRAPPER()</strong> function.
The example below doesn't include the full loader snippet source code but you can get the full code of the loader snippet from here: <a href="tutorial-loader-snippet.html">Non-Blocking Loader Snippet</a></li>
</ol>
<pre class="prettyprint source lang-html"><code>&lt;script>
var BOOMERANG_LOADER_SNIPPET_WRAPPER = function() {
(function() {
  // Boomerang Loader Snippet  
  if (window.BOOMR && (window.BOOMR.version || window.BOOMR.snippetExecuted)) {
    return;
  }

  // ...
  // ...
  // ...
})();
}
&lt;/script>
</code></pre>
<ol start="2">
<li>Call <strong>BOOMERANG_LOADER_SNIPPET_WRAPPER()</strong> function when visitor opts-in.
Usually Cookie Consent popup libraries provide callback functions that help us to instrument opt-out and opt-in procedures. For simplicity we will define a callback function with example name <strong>onOptIn()</strong> where we will run the code needed for opt-in. In our case we have to place <strong>BOOMERANG_LOADER_SNIPPET_WRAPPER()</strong> in our callback function <strong>onOptIn()</strong>.</li>
</ol>
<pre class="prettyprint source lang-html"><code>&lt;script>
function onOptIn() {
  BOOMERANG_LOADER_SNIPPET_WRAPPER();
}
&lt;/script>
</code></pre>
<h2>Cookie Consent library and Consent Inline Plugin example</h2>
<p>We prepared Boomerang opt-out and opt-in examples with the popular open source project - <a href="https://github.com/osano/cookieconsent">Osano Cookie Consent popup library</a>. For the given examples below we assume that the needed Cookie Consent popup script and Boomerang Consent Inline Plugin are loaded on the page.</p>
<h3>Opt-out</h3>
<pre class="prettyprint source lang-javascript"><code>// Setup Osano Cookie popup
function onCookieConsentChange(consent) {
  if (consent === &quot;deny&quot;) {
    window.BOOMR_OPT_OUT();
  }
}

window.addEventListener(&quot;load&quot;, function() {
  window.cookieconsent.initialise({
    &quot;type&quot;: &quot;opt-out&quot;,
    &quot;content&quot;: {
      &quot;href&quot;: &quot;https://www.example.com/policies/&quot;
    },
    onInitialise: onCookieConsentChange,
    onStatusChange: onCookieConsentChange,
    onRevokeChoice: onCookieConsentChange
  });
});
</code></pre>
<h3>Opt-in</h3>
<pre class="prettyprint source lang-javascript"><code>// Setup Osano Cookie popup
function onCookieConsentChange(consent) {
  if (consent === &quot;allow&quot;) {
    window.BOOMR_OPT_IN();
  }
}

window.addEventListener(&quot;load&quot;, function() {
  window.cookieconsent.initialise({
    &quot;type&quot;: &quot;opt-in&quot;,
    &quot;content&quot;: {
      &quot;href&quot;: &quot;https://www.example.com/policies/&quot;
    },
    onInitialise: onCookieConsentChange,
    onStatusChange: onCookieConsentChange,
    onRevokeChoice: onCookieConsentChange
  });
});
</code></pre>
</article>



</section>

		</div>
	</div>

	<div class="clearfix"></div>

	

</div>
</div>


    <div class="modal fade" id="searchResults">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Search results</h4>
          </div>
          <div class="modal-body"></div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div>


<footer>


	<span class="copyright">
	© 2010-2024 the contributors to the Open Source Boomerang project and Akamai Technologies, Inc.
	</span>

<span class="jsdoc-message">
	Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.6</a>
	
		on Tue Feb 6th 2024
	
	using the <a href="https://github.com/docstrap/docstrap">DocStrap template</a>.
</span>
</footer>

<script src="scripts/docstrap.lib.js"></script>
<script src="scripts/toc.js"></script>

    <script type="text/javascript" src="scripts/fulltext-search-ui.js"></script>


<script>
$( function () {
	$( "[id*='$']" ).each( function () {
		var $this = $( this );

		$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
	} );

	$( ".tutorial-section pre, .readme-section pre, pre.prettyprint.source" ).each( function () {
		var $this = $( this );

		var example = $this.find( "code" );
		exampleText = example.html();
		var lang = /{@lang (.*?)}/.exec( exampleText );
		if ( lang && lang[1] ) {
			exampleText = exampleText.replace( lang[0], "" );
			example.html( exampleText );
			lang = lang[1];
		} else {
			var langClassMatch = example.parent()[0].className.match(/lang\-(\S+)/);
			lang = langClassMatch ? langClassMatch[1] : "javascript";
		}

		if ( lang ) {

			$this
			.addClass( "sunlight-highlight-" + lang )
			.addClass( "linenums" )
			.html( example.html() );

		}
	} );

	Sunlight.highlightAll( {
		lineNumbers : true,
		showMenu : true,
		enableDoclinks : true
	} );

	$.catchAnchorLinks( {
        navbarOffset: 10
	} );
	$( "#toc" ).toc( {
		anchorName  : function ( i, heading, prefix ) {
			return $( heading ).attr( "id" ) || ( prefix + i );
		},
		selectors   : "#toc-content h1,#toc-content h2,#toc-content h3",
		showAndHide : false,
		smoothScrolling: true
	} );

	$( "#main span[id^='toc']" ).addClass( "toc-shim" );
	$( '.dropdown-toggle' ).dropdown();

    $( "table" ).each( function () {
      var $this = $( this );
      $this.addClass('table');
    } );

} );
</script>



<!--Navigation and Symbol Display-->


<!--Google Analytics-->



    <script type="text/javascript">
        $(document).ready(function() {
            SearcherDisplay.init();
        });
    </script>


</body>
</html>